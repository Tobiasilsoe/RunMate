<!DOCTYPE html>
<html>
<head>
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style2.css">
   
</head>
<body class="body">
    <div class="pic">
    
       <img src="../runMate/images/runningManRediSort.PNG"  class="logo">
    </div>

<div class="container1">
    <div class="overskrift">
    <h2 >
    Runmate
    </h2>
    <h3 >
    Create account
    </h3>
</div>

  <form id="theForm" action="login.html"> <!--method = "post" action="http://localhost:7000/make-reservation"-->
    <label for="name">Username</label>
    <input type="text" id="name" name="name" required>

    <label for="passwd">Password</label>
      
    <input type="password" id="passwd" name="passwd" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters" required class="passcheck" data-placement="bottom">
    
      <div id="message" class="passcheck">
  <h3>Password must contain the following:</h3>
  <p id="letter" class="invalid">A <b>lowercase</b> letter</p>
  <p id="capital" class="invalid">A <b>capital (uppercase)</b> letter</p>
  <p id="number" class="invalid">A <b>number</b></p>
  <p id="length" class="invalid">Minimum <b>8 characters</b></p>
</div>
      <div id="arrow"></div>
    
    <input type="submit" value="Create account" onclick="myFunction()">
  </form>
    <form action="login.html">
    <input type="submit" value='Go to "login"' />
</form>
</div>

    </body>   
				
<script>
var myInput = document.getElementById("passwd");
var letter = document.getElementById("letter");
var capital = document.getElementById("capital");
var number = document.getElementById("number");
var length = document.getElementById("length");

// When the user clicks on the password field, show the message box
myInput.onfocus = function() {
    document.getElementById("message").style.display = "block";
    document.getElementById("arrow").style.display = "block";
}

// When the user clicks outside of the password field, hide the message box
myInput.onblur = function() {
    document.getElementById("message").style.display = "none";
    document.getElementById("arrow").style.display = "none";
}

// When the user starts to type something inside the password field
myInput.onkeyup = function() {
  // Validate lowercase letters
  var lowerCaseLetters = /[a-z]/g;
  if(myInput.value.match(lowerCaseLetters)) {  
    letter.classList.remove("invalid");
    letter.classList.add("valid");
  } else {
    letter.classList.remove("valid");
    letter.classList.add("invalid");
  }
  
  // Validate capital letters
  var upperCaseLetters = /[A-Z]/g;
  if(myInput.value.match(upperCaseLetters)) {  
    capital.classList.remove("invalid");
    capital.classList.add("valid");
  } else {
    capital.classList.remove("valid");
    capital.classList.add("invalid");
  }

  // Validate numbers
  var numbers = /[0-9]/g;
  if(myInput.value.match(numbers)) {  
    number.classList.remove("invalid");
    number.classList.add("valid");
  } else {
    number.classList.remove("valid");
    number.classList.add("invalid");
  }
  
  // Validate length
  if(myInput.value.length >= 8) {
    length.classList.remove("invalid");
    length.classList.add("valid");
  } else {
    length.classList.remove("valid");
    length.classList.add("invalid");
  }
}

document.getElementById('theForm').addEventListener("submit",function(e) {
    e.preventDefault(); // before the code
    
    /* do what you want with the form */
    // ajax call 
    $.ajax({
        type: "POST",
        url: "http://localhost:7000/create-user/"+$('#name').val()+'/'+$('#passwd').val(),
        // serialized fields from the form ... 
        //data: $("#theForm").serialize(), 
        success: function (data) {
            console.log(data);
            alert("Du er nu oprettet");
       window.location.replace("login.html");
        },
        error: function (data) {
            console.log("error!");
        },
    });
    
    // Should be triggered on form submit
    console.log('submitting...');
  });



</script>


</html>
